<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Miss Universe Hub</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
<script type="module" src="app.js"></script>
</head>
<body>

<div id="p5-background"></div>
<div id="save-status">Guardado en la nube</div>

<div id="login-overlay">
  <div class="login-box">
    <h1>Miss Universe Hub</h1>
    <p>Comunidad Privada</p>
    <div class="input-group"><label>Usuario</label><input type="text" id="inp-username"></div>
    <div class="input-group"><label>Contraseña</label><input type="password" id="inp-password"></div>
    <button class="btn-login" id="btn-enter">ENTRAR</button>
    <div class="error-msg" id="login-msg"></div>
  </div>
</div>

<div id="mobile-warning" class="mobile-overlay" style="display:none">
  <div class="mobile-msg"><h2>⚠️ Atención</h2><p>Esta app está optimizada para PC/Tablet.</p><button id="btn-close-mobile">Entendido</button></div>
</div>

<div id="slot-search-modal">
  <div class="search-modal-content">
    <div class="search-modal-header"><h3>Asignar Delegada</h3><span class="close-modal" id="close-slot-search">&times;</span></div>
    <input type="text" id="slot-search-input" placeholder="País...">
    <div id="slot-search-results"></div>
  </div>
</div>

<div id="app-container">
    <nav class="hub-nav">
      <button class="tab-btn active" data-tab="app-top-builder">MU25 TOP</button>
      <button class="tab-btn" data-tab="app-scoring">Votaciones en vivo</button>
      <div class="user-info"><span class="user-name" id="display-user">...</span><button id="btn-logout" class="btn-logout">Salir</button></div>
    </nav>

    <div id="app-top-builder" class="tab-content active">
      
      <aside class="floating-sidebar">
          <h3>Selecciones de la comunidad</h3>
          <div id="sidebar-top-list" class="simple-list">
             <div class="loading-text">Cargando...</div>
          </div>
      </aside>

      <div class="app">
        <div class="topbar"><h1 class="title">Miss Universe Official Top</h1><div class="hint">Arrastra a tus favoritas</div></div>
        <div class="grid">
          <section class="col"><h2>Top 30</h2><div id="col-A"></div></section>
          <section class="col"><h2>Top 30</h2><div id="col-B"></div></section>
          <section class="col"><h2>Top 12</h2> <div id="col-C"></div></section>
          <section class="col"><h2>Top 3 Final</h2>  <div id="col-D"></div></section>
        </div>
        <section class="pool" id="pool">
          <div class="pool-header"><h3>Delegadas Disponibles (<span id="pool-count">0</span>)</h3><input type="search" id="search-bar" placeholder="Buscar..."></div>
          <div class="banca-container"><h4>Banca</h4><div id="banca-slots"></div></div>
          <div id="cards" class="cards"></div>
        </section>
        <div class="foot">
          <div class="bar">
            <button id="btn-clear" class="btn">Limpiar</button>
            <span class="sep"></span>
            <button id="btn-shuffle" class="btn">Mezclar</button>
            <button id="btn-sort" class="btn">A-Z</button>
            <span class="sep"></span>
            <div class="export-group" style="display:flex; gap:10px; align-items:center;">
                <span class="status" style="font-size:12px; color:#aaa;">Exportar Imagen</span>
                <button class="btn primary" id="btn-img-30">Top 30</button>
                <button class="btn primary" id="btn-img-12">Top 12</button>
                <button class="btn primary" id="btn-img-5">Top 5</button>
            </div>
            <span class="status" id="status-text">...</span>
          </div>
        </div>
      </div>
    </div>

    <div id="app-scoring" class="tab-content">
      
      <aside class="floating-sidebar">
          <h3>Votos de la comunidad</h3>
          <div id="sidebar-scoring-list" class="simple-list">
             <div class="loading-text">Cargando...</div>
          </div>
      </aside>

      <div class="app">
        <div class="topbar"><h1 class="title">Votaciones</h1></div>
        <div class="carousel-nav">
          <button id="btn-prev" class="nav-btn">Prev</button><div id="counter">0 / 0</div><button id="btn-next" class="nav-btn">Next</button>
        </div>
        <div class="carousel-wrapper"><div id="card-container"></div></div>
        <div class="ranking-container"><h2>Ranking en Vivo (Top 30)</h2><div id="ranking-list"></div></div>
      </div>
    </div>
</div>

<div id="export-stage-container" style="position:fixed; left:-9999px; top:0;">
    <div id="export-stage">
        <div class="export-header"><h1>MISS UNIVERSE 2025</h1><h2 id="export-subtitle">MY TOP 30</h2></div>
        <div id="export-grid" class="export-grid"></div>
        <div class="export-footer"><p>Prediccion por: <span id="export-username">User</span></p><p>#Miss Universe #MU25</p></div>
    </div>
</div>

<script>
(function() {
  const tabs=document.querySelectorAll('.tab-btn'), contents=document.querySelectorAll('.tab-content');
  tabs.forEach(tab=>tab.addEventListener('click',()=>{
     contents.forEach(c=>c.classList.remove('active')); tabs.forEach(t=>t.classList.remove('active'));
     document.getElementById(tab.dataset.tab).classList.add('active'); tab.classList.add('active');
  }));
  if(window.innerWidth<768){const m=document.getElementById('mobile-warning'); if(m){ m.style.display='flex'; document.getElementById('btn-close-mobile').onclick=()=>{m.style.display='none'};}}
})();
function setup(){let cnv=createCanvas(windowWidth,windowHeight);cnv.parent('p5-background');noStroke();}
function windowResized(){resizeCanvas(windowWidth,windowHeight);}
let particles=[];
function draw(){clear(); if(frameCount%5===0)particles.push(new P());for(let i=particles.length-1;i>=0;i--){particles[i].up();particles[i].show();if(particles[i].done())particles.splice(i,1);}}
class P{constructor(){this.x=random(width);this.y=height+50;this.alpha=0;this.d=random(10,100);this.v=random(1,3);}up(){this.y-=this.v;this.alpha=this.y>height-100?min(this.alpha+2,50):max(this.alpha-0.5,0);}show(){fill(255,215,0,this.alpha);circle(this.x,this.y,this.d);}done(){return this.y<-50;}}
</script>
</body>
</html> 
